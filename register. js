alert("register.js loaded");
import { auth, db } from "./firebase-config.js";
import { createUserWithEmailAndPassword }
from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
import { ref, set }
from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

const form = document.getElementById("registerForm");

form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const phone = document.getElementById("phone").value.trim();
    const pass = document.getElementById("password").value.trim();
    const cpass = document.getElementById("cpassword").value.trim();

    if (pass !== cpass) {
        alert("পাসওয়ার্ড মিলেনি");
        return;
    }

    // phone → email trick
    const email = phone + "@app.com";

    try {
        await createUserWithEmailAndPassword(auth, email, pass);

        await set(ref(db, "users/" + phone), {
            phone: phone,
            balance: 0,
            joined: new Date().toLocaleString()
        });

        alert("রেজিস্ট্রেশন সফল ✅");
        location.href = "login.html";

    } catch (err) {
        alert(err.message);
    }
});